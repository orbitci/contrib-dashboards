{"title":"Workflow Detail - v0.1 - Orbit CI Sample Dashboard","description":"Sample Dashboard th","widgets":[{"id":18295799077439,"definition":{"title":"Workflow","background_color":"vivid_purple","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":2546507050874916,"definition":{"title":"Workflow run count with status","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"count","formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"@_trace_root:1 $repository $workflow $branch"},"indexes":["*"],"group_by":[{"facet":"status","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count","interval":600000},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"semantic","order_by":"tags","order_reverse":false,"color_order":"shuffled","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":0,"y":0,"width":6,"height":2}},{"id":8044924908607754,"definition":{"title":"Workflow overall success rate","title_size":"16","title_align":"left","type":"query_value","requests":[{"formulas":[{"number_format":{"unit":{"type":"canonical_unit","unit_name":"percent"}},"formula":"100 - (query1 / query2 * 100)"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"@_trace_root:1 $repository $workflow $branch status:error"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"@_trace_root:1 $repository $workflow $branch"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"count"},"storage":"hot"}],"response_format":"scalar","conditional_formats":[{"comparator":">","value":80,"palette":"white_on_green"},{"comparator":"<=","value":80,"palette":"white_on_red"}]}],"autoscale":true,"text_align":"center","precision":2,"timeseries_background":{"yaxis":{"include_zero":false},"type":"area"}},"layout":{"x":6,"y":0,"width":6,"height":2}},{"id":6207596974249960,"definition":{"title":"Workflow failure rate","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"horizontal","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query2","data_source":"traces","search":{"expression":"a","nodes":{"a":"@_trace_root:1 $repository $workflow $branch status:error"},"filters":{"graph_filters":[]}},"compute":{"aggregation":"count","metric":"count","target":{"type":"node","value":"a"},"interval":600000},"group_by":[]},{"name":"query1","data_source":"traces","search":{"expression":"a","nodes":{"a":"@_trace_root:1 $repository $workflow $branch"},"filters":{"graph_filters":[]}},"compute":{"aggregation":"count","metric":"count","target":{"type":"node","value":"a"},"interval":600000},"group_by":[]}],"formulas":[{"alias":"error rate","style":{"palette":"warm","palette_index":5},"formula":"100 * query2 / query1"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":2,"width":6,"height":2}},{"id":5157490663251794,"definition":{"title":"Workflow duration","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"spans","search":{"query":"@_trace_root:1 $repository $workflow $branch"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"max","metric":"@duration","interval":300000},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"@_trace_root:1 $repository $workflow $branch"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"pc50","metric":"@duration","interval":300000},"storage":"hot"},{"name":"query3","data_source":"spans","search":{"query":"@_trace_root:1 $repository $workflow $branch"},"indexes":["*"],"group_by":[],"compute":{"aggregation":"pc90","metric":"@duration","interval":300000},"storage":"hot"}],"formulas":[{"alias":"max","formula":"query1"},{"alias":"p50","formula":"query2"},{"alias":"p90","formula":"query3"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":2,"width":6,"height":2}},{"id":3959799397002573,"definition":{"title":"Trace Stream","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","query":{"data_source":"trace_stream","query_string":"@_trace_root:1 $repository $workflow $branch","indexes":[]},"columns":[{"field":"timestamp","width":"auto"},{"field":"@orb.git.repository","width":"auto"},{"field":"@orb.workflow.name","width":"auto"},{"field":"@duration","width":"auto"},{"field":"span_count","width":"auto"},{"field":"@orb.workflow.url","width":"auto"}]}],"type":"list_stream"},"layout":{"x":0,"y":4,"width":12,"height":4}}]},"layout":{"x":0,"y":0,"width":12,"height":9}},{"id":7208361248077602,"definition":{"title":"Job","background_color":"vivid_purple","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":1539841784768735,"definition":{"title":"Failures","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch @orb.span_type:job -@orb.job.conclusion:success"},"indexes":["*"],"group_by":[{"facet":"@orb.job.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"count"},"storage":"hot"}],"formulas":[{"alias":"count","formula":"query1"}],"style":{"palette":"red","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":1074193463460417,"definition":{"title":"Duration Change","title_size":"16","title_align":"left","type":"change","requests":[{"increase_good":false,"order_by":"change","change_type":"relative","order_dir":"desc","response_format":"scalar","formulas":[{"formula":"day_before(query1)"},{"formula":"query1","alias":"Duration"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch @orb.span_type:job"},"indexes":["*"],"group_by":[{"facet":"@orb.job.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"show_present":true}]},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":4712367498563767,"definition":{"title":"Durations","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query2","data_source":"spans","search":{"query":"$repository $workflow $branch"},"indexes":["*"],"group_by":[{"facet":"@orb.git.repository","limit":10,"sort":{"aggregation":"min","order":"desc","metric":"@duration"},"should_exclude_missing":true},{"facet":"@orb.workflow.name","limit":10,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true},{"facet":"@orb.job.name","limit":10,"sort":{"aggregation":"min","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"pc50","metric":"@duration"},"storage":"hot"},{"name":"query3","data_source":"spans","search":{"query":"$repository $workflow $branch"},"indexes":["*"],"group_by":[{"facet":"@orb.git.repository","limit":10,"sort":{"aggregation":"pc50","order":"desc","metric":"@duration"},"should_exclude_missing":true},{"facet":"@orb.workflow.name","limit":10,"sort":{"aggregation":"pc50","order":"desc","metric":"@duration"},"should_exclude_missing":true},{"facet":"@orb.job.name","limit":10,"sort":{"aggregation":"pc50","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"pc95","metric":"@duration"},"storage":"hot"}],"response_format":"scalar","sort":{"count":2000,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","alias":"P50","formula":"query2"},{"cell_display_mode":"bar","alias":"P95","formula":"query3"}]}],"has_search_bar":"always"},"layout":{"x":0,"y":3,"width":12,"height":3}},{"id":7302620477253626,"definition":{"title":"","title_size":"16","title_align":"left","requests":[{"response_format":"event_list","query":{"data_source":"trace_stream","query_string":"$workflow $repository $branch @orb.span_type:job","indexes":[]},"columns":[{"field":"timestamp","width":"auto"},{"field":"@orb.workflow.name","width":"auto"},{"field":"@orb.git.branch","width":"auto"},{"field":"@duration","width":"auto"},{"field":"@orb.job.name","width":"auto"},{"field":"@orb.job.url","width":"auto"}]}],"type":"list_stream"},"layout":{"x":0,"y":6,"width":12,"height":4}}]},"layout":{"x":0,"y":9,"width":12,"height":11}},{"id":6817547958482685,"definition":{"title":"Step","background_color":"vivid_purple","show_title":true,"type":"group","layout_type":"ordered","widgets":[{"id":1013768385097621,"definition":{"title":"Step duration distribution","type":"treemap","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $step $branch @orb.span_type:step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"scalar","style":{"palette":"datadog16"},"formulas":[{"formula":"query1"}]}]},"layout":{"x":0,"y":0,"width":12,"height":4}},{"id":175077207822333,"definition":{"title":"Step duration trends","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"formulas":[{"alias":"duration","formula":"query1"}],"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step @orb.span_type:step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"timeseries","style":{"palette":"datadog16","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":0,"y":4,"width":12,"height":4}},{"id":8912151947288576,"definition":{"title":"Errors","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"spans","search":{"query":"$step $repository $branch $step @orb.span_type:step status:error"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"cardinality","order":"desc","metric":"status"},"should_exclude_missing":true}],"compute":{"aggregation":"cardinality","metric":"status"},"storage":"hot"}],"formulas":[{"alias":"count","formula":"query1"}],"style":{"palette":"red","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"bars"}]},"layout":{"x":0,"y":8,"width":6,"height":4}},{"id":4245909678974906,"definition":{"title":"Duration","title_size":"16","title_align":"left","show_legend":true,"legend_layout":"auto","legend_columns":["avg","min","max","value","sum"],"type":"timeseries","requests":[{"response_format":"timeseries","queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"formulas":[{"formula":"query1"}],"style":{"palette":"dog_classic","order_by":"values","line_type":"solid","line_width":"normal"},"display_type":"line"}]},"layout":{"x":6,"y":8,"width":6,"height":4}},{"id":1717768674886992,"definition":{"title":"Step Time Attribution (by process)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"avg","order":"desc","metric":"@duration"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@duration"},"storage":"hot"}],"response_format":"scalar","sort":{"count":100,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","alias":"duration","formula":"query1"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":12,"width":6,"height":4}},{"id":2287425039835667,"definition":{"title":"Step I/O Wait (by process)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":50,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.net_io.wait_ns"},"should_exclude_missing":true}],"compute":{"aggregation":"sum","metric":"@orb.process.net_io.wait_ns"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":50,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.net_io.wait_ns"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.net_io.wait_ns"},"should_exclude_missing":true}],"compute":{"aggregation":"sum","metric":"@orb.process.disk_io.wait_ns"},"storage":"hot"}],"response_format":"scalar","sort":{"count":1000,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","alias":"network","number_format":{"unit":{"type":"canonical_unit","unit_name":"nanosecond"}},"formula":"query1"},{"cell_display_mode":"bar","alias":"disk","number_format":{"unit":{"type":"canonical_unit","unit_name":"nanosecond"}},"formula":"query2"},{"alias":"total","number_format":{"unit":{"type":"canonical_unit","unit_name":"nanosecond"}},"formula":"query1 + query2"}]}],"has_search_bar":"auto"},"layout":{"x":6,"y":12,"width":6,"height":4}},{"id":4447514002345152,"definition":{"title":"Step Network I/O (by process)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.net_io.bytes_recv"},"should_exclude_missing":true}],"compute":{"aggregation":"sum","metric":"@orb.process.net_io.bytes_recv"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.net_io.bytes_recv"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.net_io.bytes_recv"},"should_exclude_missing":true}],"compute":{"aggregation":"sum","metric":"@orb.process.net_io.bytes_sent"},"storage":"hot"}],"response_format":"scalar","sort":{"count":200,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","alias":"in","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query1"},{"cell_display_mode":"bar","alias":"out","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query2"},{"alias":"total","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query1 + query2"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":16,"width":6,"height":4}},{"id":1466771928312922,"definition":{"title":"Step Disk I/O (by process)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.disk_io.bytes_read"},"should_exclude_missing":true}],"compute":{"aggregation":"sum","metric":"@orb.process.disk_io.bytes_read"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"$repository $workflow $branch $step"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.disk_io.bytes_read"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":10,"sort":{"aggregation":"sum","order":"desc","metric":"@orb.process.disk_io.bytes_read"},"should_exclude_missing":true}],"compute":{"aggregation":"sum","metric":"@orb.process.disk_io.bytes_written"},"storage":"hot"}],"response_format":"scalar","sort":{"count":200,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","alias":"read","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query1"},{"cell_display_mode":"bar","alias":"written","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query2"},{"alias":"total","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query1 + query2"}]}],"has_search_bar":"auto"},"layout":{"x":6,"y":16,"width":6,"height":4}},{"id":6772975045772724,"definition":{"title":"Step Memory Usage (by process)","title_size":"16","title_align":"left","type":"query_table","requests":[{"queries":[{"name":"query1","data_source":"spans","search":{"query":"$repository $workflow $branch $step @orb.span_type:process"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":50,"sort":{"aggregation":"count","order":"desc","metric":"count"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":50,"sort":{"aggregation":"avg","order":"desc","metric":"@orb.process.memory.allocated"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@orb.process.memory.allocated"},"storage":"hot"},{"name":"query2","data_source":"spans","search":{"query":"$repository $workflow $branch $step @orb.span_type:process"},"indexes":["*"],"group_by":[{"facet":"@orb.step.name","limit":50,"sort":{"aggregation":"avg","order":"desc","metric":"@orb.process.memory.allocated"},"should_exclude_missing":true},{"facet":"@orb.process.comm","limit":50,"sort":{"aggregation":"avg","order":"desc","metric":"@orb.process.memory.allocated"},"should_exclude_missing":true}],"compute":{"aggregation":"avg","metric":"@orb.process.memory.used"},"storage":"hot"}],"response_format":"scalar","sort":{"count":5000,"order_by":[{"type":"formula","index":0,"order":"desc"}]},"formulas":[{"cell_display_mode":"bar","alias":"allocated","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"formula":"query1"},{"cell_display_mode":"bar","number_format":{"unit":{"type":"canonical_unit","unit_name":"byte_in_decimal_bytes_family"}},"alias":"used","formula":"query2"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":20,"width":6,"height":4}}]},"layout":{"x":0,"y":20,"width":12,"height":25,"is_column_break":true}}],"template_variables":[{"name":"repository","prefix":"@orb.git.repository","available_values":[],"default":"*"},{"name":"workflow","prefix":"@orb.workflow.name","available_values":[],"default":"*"},{"name":"branch","prefix":"@orb.git.branch","available_values":[],"default":"*"},{"name":"step","prefix":"@orb.step.name","available_values":[],"default":"*"}],"layout_type":"ordered","notify_list":[],"reflow_type":"fixed"}
